{"version":3,"sources":["../../src/lib/download-wasm-swc.ts"],"names":["os","fs","path","Log","tar","fetch","fileExists","getRegistry","MAX_VERSIONS_TO_CACHE","downloadWasmSwc","version","wasmDirectory","variant","pkgName","tarFileName","substring","outputDirectory","join","cacheDirectory","result","envDefined","process","env","systemCacheDirectory","platform","XDG_CACHE_HOME","homedir","LOCALAPPDATA","dir","tmpdir","console","error","Error","exit","isAbsolute","resolve","cwd","promises","mkdir","recursive","extractFromTar","x","file","strip","info","tempFile","Date","now","registry","then","res","ok","status","cacheWriteStream","createWriteStream","Promise","reject","body","pipe","on","err","finally","close","rename","cacheFiles","readdir","length","sort","a","b","localeCompare","i","unlink","catch"],"mappings":"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"}